<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>网络编程-jquery form $.post提交的一些问题</title>
<META name=keywords content="">
<meta name="description" content="">
<link href="/ceshi/image/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td width="196"><img src="/ceshi/image/xxcms_logo.jpg"
				width="196" height="73"></td>
			<td width="616" align="center"><img
				src="/ceshi/image/xxcms_ad.jpg" width="540" height="73"></td>
			<td width="188"><table width="90%" border="0" align="right"
					cellpadding="0" cellspacing="0">
					<tr>
						<td width="49%" align="center">[<a href="/ceshi/index.php"
							class="xx_menu_top">返回首页 </a>]
						</td>
						<td width="51%" align="center">［<a
							href="/ceshi/group/2.html" target="_blank" class="xx_menu_top">版权声明</a>］
						</td>
					</tr>
					<tr>
						<td align="center">［<a href="#" class="xx_menu_top">加入收藏</a>］
						</td>
						<td align="center">［<a href="/ceshi/group/3.html"
							target="_blank" class="xx_menu_top">网站地图</a>］
						</td>
					</tr>
					<tr>
						<td align="center">［<a href="/ceshi/group/1.html"
							target="_blank" class="xx_menu_top">关于我们</a>］
						</td>
						<td align="center">［<a href="/ceshi/group/4.html"
							target="_blank" class="xx_menu_top">联系我们</a>］
						</td>
					</tr>
				</table></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0" class="menu">
		<tr>
			<td width="10" align="left"
				background="/ceshi/image/xxcms_bg_menu.jpg"><img
				src="/ceshi/image/xxcms_left_menu.jpg" width="8" height="60"></td>
			<td width="979" align="center" valign="middle"
				background="/ceshi/image/xxcms_bg_menu.jpg"><script
					type="text/javascript"
					src="/ceshi/include/Function.php?action=menu2"></script></td>
			<td width="11" align="right"
				background="/ceshi/image/xxcms_bg_menu.jpg"><img
				src="/ceshi/image/xxcms_right_menu.jpg" width="8" height="60"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="5"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td width="230" height="192" align="center" valign="top"><table
					width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;最新文章</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=zx"></script>
							</table></td>
					</tr>
				</table>
				<table width="100%" border="0" align="center" cellpadding="0"
					cellspacing="0">
					<tr>
						<td height="3"></td>
					</tr>
				</table>
				<table width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;推荐文章</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=tj"></script>
							</table></td>
					</tr>
				</table>
				<table width="100%" border="0" align="center" cellpadding="0"
					cellspacing="0">
					<tr>
						<td height="3"></td>
					</tr>
				</table>
				<table width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;点击排行</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=hits"></script>
							</table></td>
					</tr>
				</table></td>
			<td align="center" valign="top"><table width="99%" height="560"
					border="0" align="right" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="414" valign="top"><table width="100%" border="0"
								align="center" cellpadding="0" cellspacing="0">
								<tr>
									<td width="39" height="26" align="center"
										background="/ceshi/image/xxcms_bg_t.jpg"><img
										src="/ceshi/image/xxcms_arr.jpg" width="16" height="22"></td>
									<td align="left" background="/ceshi/image/xxcms_bg_t.jpg"
										class="xxcms_title">网络编程</td>
								</tr>
							</table>

							<table width="98%" border="0" align="center" cellpadding="0"
								cellspacing="0">
								<tr>
									<td height="30" align="center" valign="middle"><strong>jquery form $.post提交的一些问题</strong></td>
								</tr>
								<tr>
									<td height="30" align="center" valign="middle">来源：夏日博客
										点击次数： <script type="text/javascript"
											src="/ceshi/include/Function.php?action=dj&num=12"></script>
										发布时间：2013-01-15 22:15:18
									</td>
								</tr>
								<tr>
									<td align="left" valign="middle">对应js处理页面：<BR>/**<BR>* <BR>*/<BR>$(function() {//加载完后处理页面<BR>//alert($("#faceimg").attr("src")) ;<BR>$("#faceimg").click(function(){<BR>window.open('face.php','face','width=400,height=400,top=0,left=0,scrollbars=1');<BR>});<BR><BR>$("#mycheckcode").click(<BR>function(){<BR>var url="includes/code.php?aa="+Math.random();<BR>$("#mycheckcode").attr("src",url);<BR><BR>}<BR>);<BR>/***<BR>//输入的每个值都要以post的方法放到data里面<BR>var adata='';<BR>$("input").each(<BR>function(){<BR>adata+=$(this).attr('name')+"="+$(this).val()+"&amp;";<BR>}<BR>);<BR><BR>$.ajax({<BR>type: "POST",//提交的方式 <BR>url: "registerProcess.php",//提交对应的页面<BR>dataType: "json",//返回的是什么格式<BR>data:adata,//post过去的data<BR>fail:function(msg){<BR>//失败处理函数<BR>},<BR>success:function(){<BR>//成功处理函数<BR><BR>}<BR>}); <BR>**/<BR>//作验证<BR>//如果是必填的，则加红星标识.<BR>$("form :input.required").each(function(){<BR>var $required = $("&lt;strong class='high'&gt; *&lt;/strong&gt;"); //创建元素<BR>$(this).parent().append($required); //然后将它追加到文档中<BR>});<BR>//文本框失去焦点后<BR>$('form :input').blur(function(){<BR>var $parent = $(this).parent();<BR>$parent.find(".formtips").remove();<BR>//验证用户名<BR>if( $(this).is('#username') ){<BR>if( this.value=="" || this.value.length &lt; 6 ){<BR>var errorMsg = '请输入至少6位的用户名.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var username = {"username":$(this).val()}; //json格式传过处理页面<BR>var changeurl = "action/UserAction.php?act=IsExistUserName&amp;flg=ling"; <BR>//用Post的方式 提交过去,验证用户名是否存在 <BR>$.post(changeurl,username,function(res){//成功返回值 <BR>if(res==1){<BR>var errorMsg ="用户名好受欢迎哦，再试下其他的吧";<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var okMsg ="用户名可用.";<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}<BR>});<BR>}<BR><BR>}<BR>//验证密码长度<BR>if($(this).is("#password")){<BR>if(this.value==""||this.value.length&lt;2){<BR>var errorMsg = '请输入至少2个字符的密码.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}<BR><BR><BR>}<BR>//验证两次密码是否一致<BR>if($(this).is('#repassword')){<BR>if(this.value==""||this.value.length&lt;2){<BR>var errorMsg = '请输入至少2个字符的密码.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var password=$("#password").val();//取到密码的值<BR>if(this.value!=password){<BR>var errorMsg = '两次密码输入不一致.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}<BR>}<BR>}<BR><BR>//密码问题和密码提示要至少2个字符<BR>if($(this).is("#passtips")||$(this).is("#passans")){<BR>if( this.value=="" || this.value.length &lt; 6 ){<BR>var errorMsg = '请输入至少2位.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}<BR>}<BR><BR>//验证邮件<BR>if( $(this).is('#email') ){<BR>if( this.value=="" || ( this.value!="" &amp;&amp; !/.+@.+\.[a-zA-Z]{2,4}$/.test(this.value) ) ){<BR>var errorMsg = '请输入正确的E-Mail地址.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR>}else{<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}<BR>}<BR><BR>//验证qq<BR>var qq=/[1-9][0-9]{4,}/ ;<BR>if($(this).is("#qq")){<BR>if(qq.test(this.value) ){<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}else{<BR>var errorMsg = '请输入正确的QQ.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR><BR>}<BR>}<BR>//验证地址<BR>var url=/^https?:\/\/(\w+\.)?[\w\-\.]+(\.\w+)+$/ ;<BR>if($(this).is("#url")){<BR>if(url.test(this.value) ){<BR>var okMsg = '输入正确.';<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR>}else{<BR>var errorMsg = '请输入正确的地址格式.';<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR><BR>}<BR>}<BR>if($(this).is("#code")){<BR>var url="includes/getSession.php";<BR>$.post(url, {'sessionName':this.name,'value':this.value},function(res){<BR>if(res==1){<BR>var okMsg ="输入正确";<BR>$parent.append('&lt;span class="formtips onSuccess"&gt;'+okMsg+'&lt;/span&gt;');<BR><BR>}else{<BR>var errorMsg ="验证码不正确";<BR>$parent.append('&lt;span class="formtips onError"&gt;'+errorMsg+'&lt;/span&gt;');<BR><BR>}<BR>});<BR><BR>}<BR>}).focus(function(){//重新操作时重新赋值事件<BR>$(this).triggerHandler("blur");//绑定处理事件<BR>});<BR>/**这部分个人感觉有点多了<BR>.keyup(function(){<BR>$(this).triggerHandler("blur");<BR>}).focus(function(){<BR>$(this).triggerHandler("blur");<BR>});**///end blur<BR><BR><BR>//提交，最终验证。<BR>$('#send').click(function(){<BR>$("form:input.required").trigger('blur');<BR>var numError = $('form .onError').length;<BR>if(numError){<BR>return false;<BR>} <BR>var url="registerProcess.php";<BR>//var data={'username':$("#username").val(),'password':$("#password").val(),'repassword':$("#repassword").val(),'passtips':$('#passtips').val(),'passans':$("#passans").val(),<BR>// 'email':$("#email").val(),'qq':$("#qq").val(),'sex':$(":input[name='sex'][checked]").val(),'url':$("#url"),'faceimg':$("#faceimg").attr("src")};<BR><BR>$.post(url,$("#myform").serialize(),function(res){<BR>if(res==1){<BR>alert("注册成功,请进入登录界面");<BR>}else{<BR>alert("没有成功");<BR>}<BR><BR>});<BR><BR>});<BR><BR>//重置<BR>$('#res').click(function(){<BR>$(".formtips").remove(); <BR>});<BR><BR><BR>});<BR><BR><BR>而处理form表单处理页面registerProcess.php<BR>&lt;?php<BR>//处理register过来的内容<BR><BR>if(!defined('IN_TG')){<BR>exit('Access Defined');<BR>}<BR>//唯一标识 md5(uniqid(rand(),true));32位 更历害的可以是40位的 sha1(uniqid(rand(),true));<BR>require_once ROOT_PATH.'includes/common.inc.php';<BR>require_once ROOT_PATH.'model/userservice.class.php';<BR>$hCon=new stdClass();//设置一个对象<BR>$hCon-&gt;uniqid=$_SESSION['uniqid'];<BR>$hCon-&gt;active=$_SESSION['active'];<BR>$hCon-&gt;username=trim($_POST['username']);//去掉空格<BR>$hCon-&gt;password=md5($_POST['password']);//密码加密<BR>$hCon-&gt;repassword=md5($_POST['repassword']);<BR>$hCon-&gt;question=_mysql_string($_POST['passtips']);//去掉转义字符 <BR>$hCon-&gt;answer=_mysql_string($_POST['passans']);<BR>$hCon-&gt;sex=_mysql_string($_POST['sex']);<BR>$hCon-&gt;face=_mysql_string($_POST['faceimg']);<BR>$hCon-&gt;qq=$_POST['qq'];<BR>$hCon-&gt;url=_mysql_string($_POST['url']);<BR>$hCon-&gt;email=_mysql_string($_POST['email']);<BR>session_start();<BR>if($hCon-&gt;uniqid!=$_SESSION['uniqid']){<BR>_alert_back("防止恶意提交表单");<BR>}<BR>$userservice=new CUserService();<BR>$res=$userservice-&gt;addUser($hCon);<BR>print $res; </td>
								</tr>
							</table></td>
					</tr>
				</table></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="5"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0" bgcolor="#DCDCDC">
		<tr>
			<td height="1"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="60" align="center"><script type="text/javascript"
					src="/ceshi/include/Function.php?action=copyright"></script></td>
		</tr>
	</table>
</body>
</html>
