<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>脚本下载-服务器的w3wp.exe进程占用cpu和内存过多的问题</title>
<META name=keywords content="">
<meta name="description" content="">
<link href="/ceshi/image/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td width="196"><img src="/ceshi/image/xxcms_logo.jpg"
				width="196" height="73"></td>
			<td width="616" align="center"><img
				src="/ceshi/image/xxcms_ad.jpg" width="540" height="73"></td>
			<td width="188"><table width="90%" border="0" align="right"
					cellpadding="0" cellspacing="0">
					<tr>
						<td width="49%" align="center">[<a href="/ceshi/index.php"
							class="xx_menu_top">返回首页 </a>]
						</td>
						<td width="51%" align="center">［<a
							href="/ceshi/group/2.html" target="_blank" class="xx_menu_top">版权声明</a>］
						</td>
					</tr>
					<tr>
						<td align="center">［<a href="#" class="xx_menu_top">加入收藏</a>］
						</td>
						<td align="center">［<a href="/ceshi/group/3.html"
							target="_blank" class="xx_menu_top">网站地图</a>］
						</td>
					</tr>
					<tr>
						<td align="center">［<a href="/ceshi/group/1.html"
							target="_blank" class="xx_menu_top">关于我们</a>］
						</td>
						<td align="center">［<a href="/ceshi/group/4.html"
							target="_blank" class="xx_menu_top">联系我们</a>］
						</td>
					</tr>
				</table></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0" class="menu">
		<tr>
			<td width="10" align="left"
				background="/ceshi/image/xxcms_bg_menu.jpg"><img
				src="/ceshi/image/xxcms_left_menu.jpg" width="8" height="60"></td>
			<td width="979" align="center" valign="middle"
				background="/ceshi/image/xxcms_bg_menu.jpg"><script
					type="text/javascript"
					src="/ceshi/include/Function.php?action=menu2"></script></td>
			<td width="11" align="right"
				background="/ceshi/image/xxcms_bg_menu.jpg"><img
				src="/ceshi/image/xxcms_right_menu.jpg" width="8" height="60"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="5"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td width="230" height="192" align="center" valign="top"><table
					width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;最新文章</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=zx"></script>
							</table></td>
					</tr>
				</table>
				<table width="100%" border="0" align="center" cellpadding="0"
					cellspacing="0">
					<tr>
						<td height="3"></td>
					</tr>
				</table>
				<table width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;推荐文章</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=tj"></script>
							</table></td>
					</tr>
				</table>
				<table width="100%" border="0" align="center" cellpadding="0"
					cellspacing="0">
					<tr>
						<td height="3"></td>
					</tr>
				</table>
				<table width="100%" border="0" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="26" background="/ceshi/image/xxcms_hdp.jpg"
							class="xxcms_title">&nbsp;&nbsp;&nbsp;点击排行</td>
					</tr>
					<tr>
						<td><table width="100%" height="28" border="0" align="center"
								cellpadding="0" cellspacing="0">
								<script type="text/javascript"
									src="/ceshi/include/Function.php?action=hits"></script>
							</table></td>
					</tr>
				</table></td>
			<td align="center" valign="top"><table width="99%" height="560"
					border="0" align="right" cellpadding="0" cellspacing="0"
					class="xxcms_border">
					<tr>
						<td height="414" valign="top"><table width="100%" border="0"
								align="center" cellpadding="0" cellspacing="0">
								<tr>
									<td width="39" height="26" align="center"
										background="/ceshi/image/xxcms_bg_t.jpg"><img
										src="/ceshi/image/xxcms_arr.jpg" width="16" height="22"></td>
									<td align="left" background="/ceshi/image/xxcms_bg_t.jpg"
										class="xxcms_title">脚本下载</td>
								</tr>
							</table>

							<table width="98%" border="0" align="center" cellpadding="0"
								cellspacing="0">
								<tr>
									<td height="30" align="center" valign="middle"><strong>服务器的w3wp.exe进程占用cpu和内存过多的问题</strong></td>
								</tr>
								<tr>
									<td height="30" align="center" valign="middle">来源：夏日博客
										点击次数： <script type="text/javascript"
											src="/ceshi/include/Function.php?action=dj&num=18"></script>
										发布时间：2013-01-15 22:19:01
									</td>
								</tr>
								<tr>
									<td align="left" valign="middle">&nbsp;在IIS6下，经常出现w3wp.exe的内存及CPU占用不能及时释放，从而导致服务器响应速度很慢。<BR><BR>解决CPU占用过多：<BR>1、在IIS中对每个网站进行单独的应用程序池配置。即互相之间不影响。<BR>2、设置应用程序池的CPU监视，不超过25%（服务器为4CPU），每分钟刷新，超过限制时关闭。<BR><BR>根据w3wp取得是哪一个应用程序池：<BR><BR>1、在任务管理器中增加显示pid字段。就可以看到占用内存或者cpu最高的进程pid<BR>2、在命令提示符下运行iisapp -a。注意，第一次运行，会提示没有js支持，点击确定。然后再次运行就可以了。这样就可以看到pid对应的应用程序池。（iisapp实际上是存放在C:\windows\system32目录下的一个VBS脚本，全名为iisapp.vbs，如果你和我一样，也禁止了Vbs默认关联程序，那么就需要手动到该目录，先择打开方式，然后选“Microsoft (r) Windows Based Script Host”来执行，就可以得到PID与应用程序池的对应关系。）<BR>3、到iis中察看该应用程序池对应的网站，就ok了，做出上面的内存或CPU方面的限制，或检查程序有无死循环之类的问题。<BR><BR>&nbsp;&nbsp;&nbsp; 解决内存占用过多，可以做以下配置：<BR><BR>1、在IIS中对每个网站进行单独的应用程序池配置。即互相之间不影响。<BR>2、设置应用程序池的回收时间，默认为1720小时，可以根据情况修改。再设置当内存占用超过多少（如500M），就自动回收内存。<BR><BR>我的设置如下：<BR><BR>&nbsp;&nbsp;&nbsp; 首先是对CPU的限制：在启用cpu监视后，我设置该应用程序池最大的cpu使用率为50%。设置刷新cpu时间为1分钟，设置操作为“关闭”。最大工作进程数设置为1。这个意思是，IIS刷新检测该独立池的CPU使用情况时间为1分钟，如果超过设置的cpu限制50％，就会发出关闭池的指令，要求池在指定的时间内关闭。如果池成功在这个时间内关闭，IIS会重启动一个新池，此段时间很短，一般不会有什么感觉，池就重新开启了，对于访问网站的人基本是不会有感觉的。但如果池没有在指定时间内关闭，IIS就会强行关闭它一个刷新CPU时间。在这个停止的时间内，网站无法访问，提示“Service Unavaliable”。 </td>
								</tr>
							</table></td>
					</tr>
				</table></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="5"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0" bgcolor="#DCDCDC">
		<tr>
			<td height="1"></td>
		</tr>
	</table>
	<table width="1000" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td height="60" align="center"><script type="text/javascript"
					src="/ceshi/include/Function.php?action=copyright"></script></td>
		</tr>
	</table>
</body>
</html>
